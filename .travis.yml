language: elm
elm:
  - elm0.19.0
elm-test: 0.19.0-rev3
elm-format: 0.8.0

branches:
  only:
    - master

cache:
  directories:	
    - node_modules

before_script:
  - rm -rf ./dist
  - elm-format --validate .
  - elm-test
  - mkdir dist
  - cp ./index.html ./dist/index.html

script:
  - elm make src/HomePage.elm --output=./dist/bundle.js

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  local_dir: dist
  on:
    branch: master